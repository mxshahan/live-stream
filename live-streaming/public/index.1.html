<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://cdn.bootcss.com/flv.js/1.4.0/flv.min.js"></script>
    <title>Document</title>
</head>

<body>
        <h1>Hello</h1>

        <video id="videoElement" autoplay></video>
        <script>
            if (flvjs.isSupported()) {
                var videoElement = document.getElementById('videoElement');
                var flvPlayer = flvjs.createPlayer({
                    type: 'flv',
                    url: 'rtmp://localhost:1900/live/shahan12.flv'
                });
                flvPlayer.attachMediaElement(videoElement);
                flvPlayer.load();
                flvPlayer.play();
            }
        </script> 

    <!-- <div id="loginPage" class="container text-center">

        <div class="row">
            <div class="col-md-4 col-md-offset-4">

                <h2>WebRTC Video Demo. Please sign in</h2>
                <label for="usernameInput" class="sr-only">Login</label>
                <input type="email" id="usernameInput" class="form-control formgroup" placeholder="Login" required=""
                    autofocus="">
                <button id="loginBtn" class="btn btn-lg btn-primary btnblock">
                    Sign in</button>

            </div>
        </div>

    </div>

    <div id="callPage" class="call-page">
        <video id="localVideo" autoplay></video>
        <video id="remoteVideo" autoplay></video>

        <div class="row text-center">
            <div class="col-md-12">
                <input id="callToUsernameInput" type="text" placeholder="username to call" />
                <button id="callBtn" class="btn-success btn">Call</button>
                <button id="hangUpBtn" class="btn-danger btn">Hang Up</button>
            </div>
        </div>

    </div>
    <script>
        var conn = new WebSocket('ws://localhost:8000/live/shahan.flv')
        console.log(conn)
        var remoteVideo = document.getElementById('remoteVideo');
        remoteVideo.srcObject = (conn)
    </script> -->
<!-- 
    <script>
        //our username 
        var name;
        var connectedUser;

        //connecting to our signaling server 
        var conn = new WebSocket('ws://localhost:9090');

        conn.onopen = function () {
            console.log("Connected to the signaling server");
        };

        //when we got a message from a signaling server 
        conn.onmessage = function (msg) {
            console.log("Got message", msg.data);
            var data = msg.data;

            switch (data.type) {
                case "login":
                    handleLogin(data.success);
                    break;
                //when somebody wants to call us 
                case "offer":
                    handleOffer(data.offer, data.name);
                    break;
                case "answer":
                    handleAnswer(data.answer);
                    break;
                //when a remote peer sends an ice candidate to us 
                case "candidate":
                    handleCandidate(data.candidate);
                    break;
                case "leave":
                    handleLeave();
                    break;
                default:
                    break;
            }
        };

        conn.onerror = function (err) {
            console.log("Got error", err);
        };

        //alias for sending JSON encoded messages 
        function send(message) {
            //attach the other peer username to our messages 
            console.log(message)
            if (connectedUser) {
                message.name = connectedUser;
            }

            conn.send(JSON.stringify(message));
        };

        //****** 
        //UI selectors block 
        //****** 

        var loginPage = document.querySelector('#loginPage');
        var usernameInput = document.querySelector('#usernameInput');
        var loginBtn = document.querySelector('#loginBtn');

        var callPage = document.querySelector('#callPage');
        var callToUsernameInput = document.querySelector('#callToUsernameInput');
        var callBtn = document.querySelector('#callBtn');

        var hangUpBtn = document.querySelector('#hangUpBtn');

        var localVideo = document.querySelector('#localVideo');
        var remoteVideo = document.querySelector('#remoteVideo');

        var yourConn;
        var stream;

        //hide call page 
        callPage.style.display = "none";

        // Login when the user clicks the button 
        loginBtn.addEventListener("click", function (event) {
            name = usernameInput.value;
            console.log(name)

            if (name.length > 0) {
                send({
                    type: "login",
                    name: name
                });
            }

        });

        function handleLogin(success) {
            console.log('h')

            if (success === false) {
                alert("Ooops...try a different username");
            } else {
                loginPage.style.display = "none";
                callPage.style.display = "block";

                //********************** 
                //Starting a peer connection 
                //********************** 

                //getting local video stream 
                navigator.webkitGetUserMedia({ video: true, audio: true }, function (myStream) {
                    stream = myStream;

                    //displaying local video stream on the page 
                    localVideo.src = window.URL.createObjectURL(stream);

                    //using Google public stun server 
                    var configuration = {
                        "iceServers": [{ "url": "stun:stun2.1.google.com:19302" }]
                    };

                    yourConn = new webkitRTCPeerConnection(configuration);

                    // setup stream listening 
                    yourConn.addStream(stream);

                    //when a remote user adds stream to the peer connection, we display it 
                    yourConn.onaddstream = function (e) {
                        remoteVideo.src = window.URL.createObjectURL(e.stream);
                    };

                    // Setup ice handling 
                    yourConn.onicecandidate = function (event) {

                        if (event.candidate) {
                            send({
                                type: "candidate",
                                candidate: event.candidate
                            });
                        }

                    };

                }, function (error) {
                    console.log(error);
                });
            }
        };

        // const getUserMedia = navigator.mediaDevices.getUserMedia({
        //     audio: true,
        //     video: true
        // }, function () {
        //     console.log('success')
        // }, function() {
        //     console.log('failed')
        // })

        // getUserMedia.then(function (stream) {
        //     video.srcObject= stream;
        //     console.log(stream.getVideoTracks())
        // });
        // var pc = RTCPeerConnection({ iceServers: [{ url: 'stun:stun.l.google.com:19302' }] })

        // var peerConnection = new RTCPeerConnection(); 
        // console.log(peerConnection)
        // var dataChannel = peerConnection.createDataChannel("myChannel", dataChannelOptions); 

    </script> -->
</body>

</html>